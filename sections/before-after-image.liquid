<div class="multicolumn-custom-section">
    <div class="page-width">
      <div class="grid grid--1-col grid--{{ section.settings.columns }}-col">
      
        {% if product.metafields.custom.text_field_1_title != blank or product.metafields.custom.text_field_1_description != blank and product.metafields.custom.before_image == blank or product.metafields.custom.after_image == blank %}
            <div class="grid__item" style="border-top: 1px solid #E4E3E3;padding-top: 10px;">
                {% if product.metafields.custom.before_image and product.metafields.custom.after_image %}
                    <div class="page-width comparison-wrapper">
                        <div>
                            {% if section.settings.title != blank %}
                                <h2 class="comparison-title">{{ section.settings.title }}</h2>
                            {% endif %}
                            <!-- Before & After Comparison Slider -->   
                            <div id="comparison">
                                <figure>
                                    <div id="divisor"></div>
                                </figure>
                                <input type="range" min="0" max="100" value="50" id="slider" oninput="moveDivisor()">
                            </div>
                        </div>
                    </div>
                {% endif %}
                <div class="multicolumn-item">
                {% if product.metafields.custom.text_field_1_title != blank %}
                    <h3 style="margin: 4px 0;">{{ product.metafields.custom.text_field_1_title }}</h3>
                {% endif %}
                {% if product.metafields.custom.text_field_1_description != blank %}
                    <p style="margin: 4px 0;">{{ product.metafields.custom.text_field_1_description }}</p>
                {% endif %}
                </div>
          </div>
        {% endif %}
        
        {% if product.metafields.custom.text_field_2_title != blank or product.metafields.custom.text_field_2_description != blank %}
          <div class="grid__item" style="border-top: 1px solid #E4E3E3;padding-top: 10px;">
            <div class="multicolumn-item">
              {% if product.metafields.custom.text_field_2_title != blank %}
                <h3 style="margin: 4px 0;">{{ product.metafields.custom.text_field_2_title }}</h3>
              {% endif %}
              {% if product.metafields.custom.text_field_2_description != blank %}
                <p style="margin: 4px 0;">{{ product.metafields.custom.text_field_2_description }}</p>
              {% endif %}
            </div>
          </div>
        {% endif %}

        {% if product.metafields.custom.text_field_3_title != blank or product.metafields.custom.text_field_3_description != blank %}
          <div class="grid__item" style="border-top: 1px solid #E4E3E3;padding-top: 10px;">
            <div class="multicolumn-item">
              {% if product.metafields.custom.text_field_3_title != blank %}
                <h3 style="margin: 4px 0;">{{ product.metafields.custom.text_field_3_title }}</h3>
              {% endif %}
              {% if product.metafields.custom.text_field_2_description != blank %}
                <p style="margin: 4px 0;">{{ product.metafields.custom.text_field_3_description }}</p>
              {% endif %}
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>

{% comment %} {% if product.metafields.custom.before_image and product.metafields.custom.after_image %}
    <div class="page-width comparison-wrapper">
        <div>
            {% if section.settings.title != blank %}
                <h2 class="comparison-title">{{ section.settings.title }}</h2>
            {% endif %}
            <!-- Before & After Comparison Slider -->   
            <div id="comparison">
                <figure>
                    <div id="divisor"></div>
                </figure>
                <input type="range" min="0" max="100" value="50" id="slider" oninput="moveDivisor()">
            </div>
        </div>
    </div>
{% endif %} {% endcomment %}
        
<!-- Add CSS styles -->
<style>
    #divisor:empty,
    #handle:empty {
        display: block;
    }
    div#comparison { 
        width: 40vw;
        height: 40vw;
        max-width: 600px;
        max-height: 600px;
        overflow: hidden; 
    }
    div#comparison figure { 
        background-image: url({{ product.metafields.custom.before_image | file_url }});
        background-size: cover;
        position: relative;
        font-size: 0;
        width: 100%; 
        height: 100%;
        margin: 0; 
    }
    div#comparison figure > img { 
        position: relative;
        width: 100%;
    }
    div#comparison figure div {  
        background-image: url({{ product.metafields.custom.after_image | file_url }}); 
        background-size: cover;
        position: absolute;
        width: 50%; 
        box-shadow: 0 5px 10px -2px rgba(0,0,0,0.3);
        overflow: hidden;
        bottom: 0;
        height: 100%;
    }

    input[type=range]{
        -webkit-appearance:none;
        -moz-appearance:none;
        position: relative;
        top: -2rem; left: -2%;
        background-color: rgba(255,255,255,0.1);
        width: 102%; 
    }
    input[type=range]:focus { 
        outline: none; 
    }
    input[type=range]:active { 
        outline: none;  
    }
    input[type=range]::-moz-range-track { 
        -moz-appearance:none;
        height:15px;
        width: 98%;
        background-color: rgba(255,255,255,0.1); 
        position: relative;
        outline: none;    
    }
    input[type=range]::active { 
        border: none; 
        outline: none;
    }
    input[type=range]::-webkit-slider-thumb {
        -webkit-appearance:none;
        width: 20px; height: 15px;   
        background: #fff;
        border-radius: 0;
    }
    input[type=range]::-moz-range-thumb {
        -moz-appearance: none;
        width: 20px;
        height: 15px;
        background: #fff;
        border-radius: 0;
    }   
    input[type=range]:focus::-webkit-slider-thumb {
        background: rgba(255,255,255,0.5);
    }
    input[type=range]:focus::-moz-range-thumb {
        background: rgba(255,255,255,0.5);
    }
</style>
    
<!-- Add JavaScript for the Before & After Slider functionality -->
<script>
var divisor = document.getElementById("divisor"),
    slider = document.getElementById("slider");
function moveDivisor() { 
    divisor.style.width = slider.value + "%";
}
</script>

{% schema %}
{
  "name": "Before & After Slider",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Before & After Comparison"
    }
  ]
}
{% endschema %}
